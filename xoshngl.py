#!/usr/bin/env python3
import base64, os, sys, tempfile
code = base64.b64decode('aW1wb3J0IHJhbmRvbQppbXBvcnQgc3RyaW5nCmltcG9ydCByZXF1ZXN0cwppbXBvcnQgb3MKaW1wb3J0IHRpbWUKaW1wb3J0IGFzeW5jaW8KaW1wb3J0IHNpZ25hbApmcm9tIHB5c3R5bGUgaW1wb3J0IENvbG9ycywgQ29sb3JhdGUsIFdyaXRlLCBBZGQsIENlbnRlciwgQW5pbWUsIFN5c3RlbQpmcm9tIHRlbGVncmFtIGltcG9ydCBVcGRhdGUKZnJvbSB0ZWxlZ3JhbS5leHQgaW1wb3J0IEFwcGxpY2F0aW9uLCBDb21tYW5kSGFuZGxlciwgTWVzc2FnZUhhbmRsZXIsIGZpbHRlcnMsIENvbnRleHRUeXBlcwoKY2xhc3MgWGRwelFOR0xCb3Q6CiAgICBkZWYgX19pbml0X18oc2VsZiwgdG9rZW46IHN0ciA9IE5vbmUpOgogICAgICAgIHNlbGYudG9rZW4gPSB0b2tlbgogICAgICAgIHNlbGYuYWN0aXZlX2F0dGFja3MgPSB7fQogICAgICAgIHNlbGYuYXBwbGljYXRpb24gPSBOb25lCiAgICAgICAgc2VsZi51c2VfdGVsZWdyYW1fYm90ID0gRmFsc2UgICMgRmxhZyB1bnR1ayBtZW5lbnR1a2FuIGFwYWthaCBtZW5nZ3VuYWthbiBib3QgVGVsZWdyYW0gYXRhdSB0aWRhawoKICAgIGRlZiBkZXZpY2VJZChzZWxmKToKICAgICAgICBjaGFyYWN0ZXJzID0gc3RyaW5nLmFzY2lpX2xvd2VyY2FzZSArIHN0cmluZy5kaWdpdHMKICAgICAgICBwYXJ0MSA9ICcnLmpvaW4ocmFuZG9tLmNob2ljZXMoY2hhcmFjdGVycywgaz04KSkKICAgICAgICBwYXJ0MiA9ICcnLmpvaW4ocmFuZG9tLmNob2ljZXMoY2hhcmFjdGVycywgaz00KSkKICAgICAgICBwYXJ0MyA9ICcnLmpvaW4ocmFuZG9tLmNob2ljZXMoY2hhcmFjdGVycywgaz00KSkKICAgICAgICBwYXJ0NCA9ICcnLmpvaW4ocmFuZG9tLmNob2ljZXMoY2hhcmFjdGVycywgaz00KSkKICAgICAgICBwYXJ0NSA9ICcnLmpvaW4ocmFuZG9tLmNob2ljZXMoY2hhcmFjdGVycywgaz0xMikpCiAgICAgICAgZGV2aWNlX2lkID0gZiJ7cGFydDF9LXtwYXJ0Mn0te3BhcnQzfS17cGFydDR9LXtwYXJ0NX0iCiAgICAgICAgcmV0dXJuIGRldmljZV9pZAoKICAgIGRlZiBVc2VyQWdlbnQoc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICB3aXRoIG9wZW4oJ3VzZXItYWdlbnRzLnR4dCcsICdyJykgYXMgZmlsZToKICAgICAgICAgICAgICAgIHVzZXJfYWdlbnRzID0gZmlsZS5yZWFkbGluZXMoKQogICAgICAgICAgICAgICAgcmFuZG9tX3VzZXJfYWdlbnQgPSByYW5kb20uY2hvaWNlKHVzZXJfYWdlbnRzKS5zdHJpcCgpCiAgICAgICAgICAgICAgICByZXR1cm4gcmFuZG9tX3VzZXJfYWdlbnQKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHVzZXJfYWdlbnRzID0gWwogICAgICAgICAgICAgICAgIk1vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdpbjY0OyB4NjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS8xMTMuMC4wLjAgU2FmYXJpLzUzNy4zNiIsCiAgICAgICAgICAgICAgICAiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV2luNjQ7IHg2NCkgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzExMi4wLjAuMCBTYWZhcmkvNTM3LjM2IiwKICAgICAgICAgICAgICAgICJNb3ppbGxhLzUuMCAoTWFjaW50b3NoOyBJbnRlbCBNYWMgT1MgWCAxMF8xNV83KSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvMTEzLjAuMC4wIFNhZmFyaS81MzcuMzYiCiAgICAgICAgICAgIF0KICAgICAgICAgICAgcmV0dXJuIHJhbmRvbS5jaG9pY2UodXNlcl9hZ2VudHMpCgogICAgZGVmIFByb3h5KHNlbGYpOgogICAgICAgIHRyeToKICAgICAgICAgICAgd2l0aCBvcGVuKCdwcm94aWVzLnR4dCcsICdyJykgYXMgZmlsZToKICAgICAgICAgICAgICAgIHByb3hpZXNfbGlzdCA9IGZpbGUucmVhZGxpbmVzKCkKICAgICAgICAgICAgICAgIGlmIG5vdCBwcm94aWVzX2xpc3Q6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE5vbmUKICAgICAgICAgICAgICAgIHJhbmRvbV9wcm94eSA9IHJhbmRvbS5jaG9pY2UocHJveGllc19saXN0KS5zdHJpcCgpCiAgICAgICAgICAgIHByb3hpZXMgPSB7CiAgICAgICAgICAgICAgICAnaHR0cCc6IHJhbmRvbV9wcm94eSwKICAgICAgICAgICAgICAgICdodHRwcyc6IHJhbmRvbV9wcm94eQogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBwcm94aWVzCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICByZXR1cm4gTm9uZQoKICAgIGRlZiBzZW5kX25nbF9tZXNzYWdlKHNlbGYsIG5nbHVzZXJuYW1lOiBzdHIsIG1lc3NhZ2U6IHN0ciwgdXNlX3Byb3h5OiBib29sID0gRmFsc2UpOgogICAgICAgIGhlYWRlcnMgPSB7CiAgICAgICAgICAgICdIb3N0JzogJ25nbC5saW5rJywKICAgICAgICAgICAgJ3NlYy1jaC11YSc6ICciR29vZ2xlIENocm9tZSI7dj0iMTEzIiwgIkNocm9taXVtIjt2PSIxMTMiLCAiTm90LUEuQnJhbmQiO3Y9IjI0IicsCiAgICAgICAgICAgICdhY2NlcHQnOiAnKi8qJywKICAgICAgICAgICAgJ2NvbnRlbnQtdHlwZSc6ICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQ7IGNoYXJzZXQ9VVRGLTgnLAogICAgICAgICAgICAneC1yZXF1ZXN0ZWQtd2l0aCc6ICdYTUxIdHRwUmVxdWVzdCcsCiAgICAgICAgICAgICdzZWMtY2gtdWEtbW9iaWxlJzogJz8wJywKICAgICAgICAgICAgJ3VzZXItYWdlbnQnOiBmJ3tzZWxmLlVzZXJBZ2VudCgpfScsCiAgICAgICAgICAgICdzZWMtY2gtdWEtcGxhdGZvcm0nOiAnIldpbmRvd3MiJywKICAgICAgICAgICAgJ29yaWdpbic6ICdodHRwczovL25nbC5saW5rJywKICAgICAgICAgICAgJ3NlYy1mZXRjaC1zaXRlJzogJ3NhbWUtb3JpZ2luJywKICAgICAgICAgICAgJ3NlYy1mZXRjaC1tb2RlJzogJ2NvcnMnLAogICAgICAgICAgICAnc2VjLWZldGNoLWRlc3QnOiAnZW1wdHknLAogICAgICAgICAgICAncmVmZXJlcic6IGYnaHR0cHM6Ly9uZ2wubGluay97bmdsdXNlcm5hbWV9JywKICAgICAgICAgICAgJ2FjY2VwdC1sYW5ndWFnZSc6ICd0ci1UUix0cjtxPTAuOSxlbi1VUztxPTAuOCxlbjtxPTAuNycsCiAgICAgICAgfQoKICAgICAgICBkYXRhID0gewogICAgICAgICAgICAndXNlcm5hbWUnOiBmJ3tuZ2x1c2VybmFtZX0nLAogICAgICAgICAgICAncXVlc3Rpb24nOiBmJ3ttZXNzYWdlfScsCiAgICAgICAgICAgICdkZXZpY2VJZCc6IGYne3NlbGYuZGV2aWNlSWQoKX0nLAogICAgICAgICAgICAnZ2FtZVNsdWcnOiAnJywKICAgICAgICAgICAgJ3JlZmVycmVyJzogJycsCiAgICAgICAgfQoKICAgICAgICBwcm94aWVzID0gc2VsZi5Qcm94eSgpIGlmIHVzZV9wcm94eSBlbHNlIE5vbmUKCiAgICAgICAgdHJ5OgogICAgICAgICAgICByZXNwb25zZSA9IHJlcXVlc3RzLnBvc3QoJ2h0dHBzOi8vbmdsLmxpbmsvYXBpL3N1Ym1pdCcsIGhlYWRlcnM9aGVhZGVycywgZGF0YT1kYXRhLCBwcm94aWVzPXByb3hpZXMsIHRpbWVvdXQ9MTApCiAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5zdGF0dXNfY29kZSA9PSAyMDAKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHJldHVybiBGYWxzZQoKICAgIGFzeW5jIGRlZiBzcGFtbmdsKHNlbGYsIHVwZGF0ZTogVXBkYXRlLCBjb250ZXh0OiBDb250ZXh0VHlwZXMuREVGQVVMVF9UWVBFKToKICAgICAgICB1c2VyX2lkID0gdXBkYXRlLmVmZmVjdGl2ZV91c2VyLmlkCgogICAgICAgIGlmIHVzZXJfaWQgaW4gc2VsZi5hY3RpdmVfYXR0YWNrczoKICAgICAgICAgICAgYXdhaXQgdXBkYXRlLm1lc3NhZ2UucmVwbHlfdGV4dCgi8J+UhCBLYW11IG1hc2loIG1lbWlsaWtpIHNwYW0geWFuZyBiZXJqYWxhbi4gVHVuZ2d1IHNhbXBhaSBzZWxlc2FpLiIpCiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBpZiBsZW4oY29udGV4dC5hcmdzKSA8IDM6CiAgICAgICAgICAgIGF3YWl0IHVwZGF0ZS5tZXNzYWdlLnJlcGx5X3RleHQoCiAgICAgICAgICAgICAgICAi8J+TnSAqQ2FyYSBQYWthaToqXG4iCiAgICAgICAgICAgICAgICAi4pqhIGAvc3BhbW5nbCB1c2VybmFtZSBwZXNhbiBqdW1sYWhgXG5cbiIKICAgICAgICAgICAgICAgICLwn5OMICpDb250b2g6KlxuIgogICAgICAgICAgICAgICAgIvCfjq8gYC9zcGFtbmdsIGpvaG5kb2UgaGVsbG8gd29ybGQgMTAwYFxuIgogICAgICAgICAgICAgICAgIvCfjq8gYC9zcGFtbmdsIGphbmVkb2UgdGVzdCA1MGBcblxuIgogICAgICAgICAgICAgICAgIuKPse+4jyBEZWxheSBvdG9tYXRpcyAxIGRldGlrIiwKICAgICAgICAgICAgICAgIHBhcnNlX21vZGU9J01hcmtkb3duJwogICAgICAgICAgICApCiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBuZ2x1c2VybmFtZSA9IGNvbnRleHQuYXJnc1swXQogICAgICAgIG1lc3NhZ2UgPSBjb250ZXh0LmFyZ3NbMV0KCiAgICAgICAgdHJ5OgogICAgICAgICAgICBjb3VudCA9IGludChjb250ZXh0LmFyZ3NbMl0pCiAgICAgICAgZXhjZXB0IFZhbHVlRXJyb3I6CiAgICAgICAgICAgIGF3YWl0IHVwZGF0ZS5tZXNzYWdlLnJlcGx5X3RleHQoIuKdjCBKdW1sYWggaGFydXMgYW5na2EhIikKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIGlmIGNvdW50ID4gNTAwOgogICAgICAgICAgICBhd2FpdCB1cGRhdGUubWVzc2FnZS5yZXBseV90ZXh0KCLinYwgTWFrc2ltYWwgNTAwIHBlc2FuIHBlciBzcGFtISIpCiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBkZWxheSA9IDEuMAogICAgICAgIHVzZV9wcm94eSA9IEZhbHNlCgogICAgICAgIHNlbGYuYWN0aXZlX2F0dGFja3NbdXNlcl9pZF0gPSBUcnVlCiAgICAgICAgYXN5bmNpby5jcmVhdGVfdGFzayhzZWxmLnJ1bl9zcGFtKHVwZGF0ZSwgY29udGV4dCwgdXNlcl9pZCwgbmdsdXNlcm5hbWUsIG1lc3NhZ2UsIGNvdW50LCBkZWxheSwgdXNlX3Byb3h5KSkKCiAgICAgICAgYXdhaXQgdXBkYXRlLm1lc3NhZ2UucmVwbHlfdGV4dCgKICAgICAgICAgICAgZiLwn5qAICpNZW11bGFpIFNwYW0gTkdMKlxuXG4iCiAgICAgICAgICAgIGYi8J+RpCBVc2VybmFtZTogYHtuZ2x1c2VybmFtZX1gXG4iCiAgICAgICAgICAgIGYi8J+SrCBQZXNhbjogYHttZXNzYWdlfWBcbiIKICAgICAgICAgICAgZiLwn5SiIEp1bWxhaDogYHtjb3VudH1gXG4iCiAgICAgICAgICAgIGYi4o+x77iPIERlbGF5OiBge2RlbGF5fXNgXG5cbiIKICAgICAgICAgICAgZiLij7MgTW9ob24gdHVuZ2d1Li4uIiwKICAgICAgICAgICAgcGFyc2VfbW9kZT0nTWFya2Rvd24nCiAgICAgICAgKQoKICAgIGFzeW5jIGRlZiBydW5fc3BhbShzZWxmLCB1cGRhdGU6IFVwZGF0ZSwgY29udGV4dDogQ29udGV4dFR5cGVzLkRFRkFVTFRfVFlQRSwgdXNlcl9pZDogaW50LAogICAgICAgICAgICAgICAgICAgICAgbmdsdXNlcm5hbWU6IHN0ciwgbWVzc2FnZTogc3RyLCBjb3VudDogaW50LCBkZWxheTogZmxvYXQsIHVzZV9wcm94eTogYm9vbCk6CiAgICAgICAgc2VudCA9IDAKICAgICAgICBmYWlsZWQgPSAwCiAgICAgICAgY29uc2VjdXRpdmVfZmFpbHMgPSAwCgogICAgICAgIHN0YXR1c19tc2cgPSBhd2FpdCB1cGRhdGUubWVzc2FnZS5yZXBseV90ZXh0KAogICAgICAgICAgICBmIvCfk4ogKlN0YXR1cyBTcGFtKlxuIgogICAgICAgICAgICBmIuKchSBUZXJraXJpbTogYDAve2NvdW50fWBcbiIKICAgICAgICAgICAgZiLinYwgR2FnYWw6IGAwYFxuIgogICAgICAgICAgICBmIuKPsyBQcm9ncmVzczogYDAlYCIsCiAgICAgICAgICAgIHBhcnNlX21vZGU9J01hcmtkb3duJwogICAgICAgICkKCiAgICAgICAgZm9yIGkgaW4gcmFuZ2UoY291bnQpOgogICAgICAgICAgICBpZiBub3Qgc2VsZi5hY3RpdmVfYXR0YWNrcy5nZXQodXNlcl9pZCwgRmFsc2UpOgogICAgICAgICAgICAgICAgYnJlYWsKCiAgICAgICAgICAgIHN1Y2Nlc3MgPSBzZWxmLnNlbmRfbmdsX21lc3NhZ2UobmdsdXNlcm5hbWUsIG1lc3NhZ2UsIHVzZV9wcm94eSkKCiAgICAgICAgICAgIGlmIHN1Y2Nlc3M6CiAgICAgICAgICAgICAgICBzZW50ICs9IDEKICAgICAgICAgICAgICAgIGNvbnNlY3V0aXZlX2ZhaWxzID0gMAogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgZmFpbGVkICs9IDEKICAgICAgICAgICAgICAgIGNvbnNlY3V0aXZlX2ZhaWxzICs9IDEKCiAgICAgICAgICAgIGlmIChpICsgMSkgJSA1ID09IDAgb3IgY29uc2VjdXRpdmVfZmFpbHMgPj0gMyBvciBpID09IGNvdW50IC0gMToKICAgICAgICAgICAgICAgIHByb2dyZXNzID0gaW50KChzZW50IC8gY291bnQpICogMTAwKQogICAgICAgICAgICAgICAgc3VjY2Vzc19yYXRlID0gaW50KChzZW50IC8gKHNlbnQgKyBmYWlsZWQpKSAqIDEwMCkgaWYgKHNlbnQgKyBmYWlsZWQpID4gMCBlbHNlIDAKCiAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgYXdhaXQgc3RhdHVzX21zZy5lZGl0X3RleHQoCiAgICAgICAgICAgICAgICAgICAgICAgIGYi8J+TiiAqU3RhdHVzIFNwYW0qXG4iCiAgICAgICAgICAgICAgICAgICAgICAgIGYi4pyFIFRlcmtpcmltOiBge3NlbnR9L3tjb3VudH1gXG4iCiAgICAgICAgICAgICAgICAgICAgICAgIGYi4p2MIEdhZ2FsOiBge2ZhaWxlZH1gXG4iCiAgICAgICAgICAgICAgICAgICAgICAgIGYi4o+zIFByb2dyZXNzOiBge3Byb2dyZXNzfSVgXG4iCiAgICAgICAgICAgICAgICAgICAgICAgIGYi8J+OryBTdWNjZXNzIFJhdGU6IGB7c3VjY2Vzc19yYXRlfSVgIiwKICAgICAgICAgICAgICAgICAgICAgICAgcGFyc2VfbW9kZT0nTWFya2Rvd24nCiAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgICAgIHBhc3MKCiAgICAgICAgICAgIGlmIGNvbnNlY3V0aXZlX2ZhaWxzID49IDU6CiAgICAgICAgICAgICAgICBhd2FpdCB1cGRhdGUubWVzc2FnZS5yZXBseV90ZXh0KCLimqDvuI8gQmFueWFrIGtlZ2FnYWxhbiBiZXJ0dXJ1dC10dXJ1dC4gTWVuZ2hlbnRpa2FuIHNwYW0uLi4iKQogICAgICAgICAgICAgICAgYnJlYWsKCiAgICAgICAgICAgIGF3YWl0IGFzeW5jaW8uc2xlZXAoZGVsYXkpCgogICAgICAgIGlmIHVzZXJfaWQgaW4gc2VsZi5hY3RpdmVfYXR0YWNrczoKICAgICAgICAgICAgZGVsIHNlbGYuYWN0aXZlX2F0dGFja3NbdXNlcl9pZF0KCiAgICAgICAgZmluYWxfc3VjY2Vzc19yYXRlID0gaW50KChzZW50IC8gKHNlbnQgKyBmYWlsZWQpKSAqIDEwMCkgaWYgKHNlbnQgKyBmYWlsZWQpID4gMCBlbHNlIDAKCiAgICAgICAgYXdhaXQgc3RhdHVzX21zZy5lZGl0X3RleHQoCiAgICAgICAgICAgIGYi8J+PgSAqU3BhbSBTZWxlc2FpKlxuXG4iCiAgICAgICAgICAgIGYi4pyFIEJlcmhhc2lsOiBge3NlbnR9YCBwZXNhblxuIgogICAgICAgICAgICBmIuKdjCBHYWdhbDogYHtmYWlsZWR9YCBwZXNhblxuIgogICAgICAgICAgICBmIvCfk4ogU3VjY2VzcyBSYXRlOiBge2ZpbmFsX3N1Y2Nlc3NfcmF0ZX0lYFxuIgogICAgICAgICAgICBmIvCfkaQgVGFyZ2V0OiBge25nbHVzZXJuYW1lfWBcbiIKICAgICAgICAgICAgZiLwn5KsIFBlc2FuOiBge21lc3NhZ2V9YCIsCiAgICAgICAgICAgIHBhcnNlX21vZGU9J01hcmtkb3duJwogICAgICAgICkKCiAgICBhc3luYyBkZWYgc3RhcnQoc2VsZiwgdXBkYXRlOiBVcGRhdGUsIGNvbnRleHQ6IENvbnRleHRUeXBlcy5ERUZBVUxUX1RZUEUpOgogICAgICAgIGF3YWl0IHVwZGF0ZS5tZXNzYWdlLnJlcGx5X3RleHQoCiAgICAgICAgICAgICLwn6SWICpOR0wgU3BhbW1lciBCb3QqXG5cbiIKICAgICAgICAgICAgIvCfk4sgKlBlcmludGFoOipcbiIKICAgICAgICAgICAgIuKAoiAvc3RhcnQgLSBNZW5hbXBpbGthbiBwZXNhbiBpbmlcbiIKICAgICAgICAgICAgIuKAoiAvc3BhbW5nbCAtIE1lbXVsYWkgc3BhbSBOR0xcbiIKICAgICAgICAgICAgIuKAoiAvc3RvcCAtIE1lbmdoZW50aWthbiBzcGFtXG5cbiIKICAgICAgICAgICAgIvCfk4wgKkNvbnRvaDoqXG4iCiAgICAgICAgICAgICLwn46vIGAvc3BhbW5nbCB1c2VybmFtZSBwZXNhbiBqdW1sYWhgXG4iCiAgICAgICAgICAgICLwn46vIGAvc3BhbW5nbCBqb2huZG9lIGhlbGxvIHdvcmxkIDUwYFxuXG4iCiAgICAgICAgICAgICLij7HvuI8gRGVsYXkgb3RvbWF0aXMgMSBkZXRpa1xuIgogICAgICAgICAgICAi8J+UoiBNYWtzaW1hbCA1MDAgcGVzYW4gcGVyIHNwYW0iLAogICAgICAgICAgICBwYXJzZV9tb2RlPSdNYXJrZG93bicKICAgICAgICApCgogICAgYXN5bmMgZGVmIHN0b3Aoc2VsZiwgdXBkYXRlOiBVcGRhdGUsIGNvbnRleHQ6IENvbnRleHRUeXBlcy5ERUZBVUxUX1RZUEUpOgogICAgICAgIHVzZXJfaWQgPSB1cGRhdGUuZWZmZWN0aXZlX3VzZXIuaWQKCiAgICAgICAgaWYgdXNlcl9pZCBpbiBzZWxmLmFjdGl2ZV9hdHRhY2tzOgogICAgICAgICAgICBkZWwgc2VsZi5hY3RpdmVfYXR0YWNrc1t1c2VyX2lkXQogICAgICAgICAgICBhd2FpdCB1cGRhdGUubWVzc2FnZS5yZXBseV90ZXh0KCLwn5uRIFNwYW0gYmVyaGFzaWwgZGloZW50aWthbiEiKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGF3YWl0IHVwZGF0ZS5tZXNzYWdlLnJlcGx5X3RleHQoIuKEue+4jyBUaWRhayBhZGEgc3BhbSB5YW5nIGJlcmphbGFuLiIpCgogICAgZGVmIHNldHVwX2hhbmRsZXJzKHNlbGYpOgogICAgICAgICIiIlNldHVwIGNvbW1hbmQgaGFuZGxlcnMiIiIKICAgICAgICBzZWxmLmFwcGxpY2F0aW9uLmFkZF9oYW5kbGVyKENvbW1hbmRIYW5kbGVyKCJzdGFydCIsIHNlbGYuc3RhcnQpKQogICAgICAgIHNlbGYuYXBwbGljYXRpb24uYWRkX2hhbmRsZXIoQ29tbWFuZEhhbmRsZXIoInNwYW1uZ2wiLCBzZWxmLnNwYW1uZ2wpKQogICAgICAgIHNlbGYuYXBwbGljYXRpb24uYWRkX2hhbmRsZXIoQ29tbWFuZEhhbmRsZXIoInN0b3AiLCBzZWxmLnN0b3ApKQoKICAgIGRlZiBwcmludF9iYW5uZXIoc2VsZik6CiAgICAgICAgIiIiUHJpbnQgYmFubmVyIGRlbmdhbiB3YXJuYSIiIgogICAgICAgIGJhbm5lcl90ZXh0ID0gIiIiCiAgICAgICAg4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paICiAgICAgICAg4paI4pSA4paE4paE4paE4paE4paI4paE4pSA4paE4paI4paE4pSA4paE4paE4paA4paI4paE4pSA4paE4paE4pSA4paI4paE4pSA4paE4paE4paE4paE4paI4pSA4paE4paE4paE4paE4paI4paE4pSA4paE4paE4pSA4paI4paE4pSA4paE4paE4paE4paE4paI4paE4pSA4paE4paE4pSA4paI4paE4pSA4paE4paE4paA4paI4paE4pSA4paE4paE4pSA4paI4paE4pSA4paE4paE4paE4paE4paI4paE4pSA4paE4paE4pSA4paICiAgICAgICAg4paI4paE4paE4paE4paE4pSA4paI4paI4pSA4paI4paI4paI4pSA4paA4paE4pSA4paI4paI4pSA4paE4paI4paI4paI4paE4paE4paE4paE4pSA4paI4paI4paE4paE4paE4paE4pSA4paI4paI4pSA4paE4paI4paI4paI4paI4pSA4paI4paI4pSA4paI4paI4pSA4paI4paI4pSA4paE4paI4pSA4paI4paI4pSA4paE4paI4paI4paI4paI4paE4paE4paE4paE4pSA4paI4paI4pSA4paE4paI4paI4paICiAgICAgICAg4paA4paE4pSA4paE4paE4paA4paI4paE4pSA4paE4paI4paA4pSA4paE4paE4paA4paI4paE4pSA4paE4paE4pSA4paI4paA4pSA4paE4paE4paE4paE4paI4paA4pSA4paE4paE4paE4paE4paI4paE4pSA4paE4paE4pSA4paI4paE4pSA4paE4paE4pSA4paI4paE4pSA4paE4paE4paA4paI4paE4pSA4paE4paE4pSA4paI4paA4pSA4paE4paE4paE4paE4paI4paE4pSA4paE4paE4pSA4paICiAgICAgICAg4paI4paE4paE4paE4paE4pSA4paI4paI4pSA4paI4paI4paI4pSA4paA4paE4pSA4paI4paI4pSA4paI4paI4pSA4paI4paI4paE4paE4paE4paE4pSA4paI4paI4paE4paE4paE4paE4pSA4paI4paI4pSA4paI4paI4pSA4paI4paI4pSA4paI4paI4pSA4paI4paI4pSA4paA4paE4pSA4paI4paI4pSA4paI4paI4pSA4paI4paI4paE4paE4paE4paE4pSA4paI4paI4pSA4paI4paI4pSA4paICiAgICAgICAg4paA4paE4paE4paE4paE4paE4paA4paA4paE4paE4paA4paA4paE4paE4paE4paE4paA4paA4paE4paE4paE4paA4paA4paA4paE4paE4paE4paE4paE4paA4paA4paE4paE4paE4paE4paE4paA4paA4paE4paE4paE4paA4paA4paA4paE4paE4paE4paA4paA4paE4paE4paE4paE4paA4paA4paE4paE4paE4paA4paA4paA4paE4paE4paE4paE4paE4paA4paA4paE4paE4paE4paA4paACiAgICAgICAg4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paI4paICiAgICAgICAgICAgICAgICAgICAgTkdMIFNQQU1NRVIgQk9UIHwgQVVUSE9SOiBYZHB6USB8IFRPT0xTIFY4LjQgQlkgREFOWFkgT0ZGSUNJQUwKICAgICAgICAiIiIKICAgICAgICBwcmludChDb2xvcmF0ZS5Ib3Jpem9udGFsKENvbG9ycy5yZWRfdG9feWVsbG93LCBiYW5uZXJfdGV4dCkpCiAgICAgICAgcHJpbnQoQ29sb3JhdGUuSG9yaXpvbnRhbChDb2xvcnMuZ3JlZW5fdG9fYmx1ZSwgIvCfpJYgTkdMIEJvdCBzZWRhbmcgYmVyamFsYW4uLi4iKSkKICAgICAgICBwcmludChDb2xvcmF0ZS5Ib3Jpem9udGFsKENvbG9ycy55ZWxsb3dfdG9fcmVkLCAi8J+TnSBHdW5ha2FuIC9zdGFydCBkaSBUZWxlZ3JhbSB1bnR1ayBtdWxhaSIpKQogICAgICAgIHByaW50KENvbG9yYXRlLkhvcml6b250YWwoQ29sb3JzLnJhaW5ib3csICI9IiAqIDUwKSkKCiAgICBkZWYgcnVuKHNlbGYpOgogICAgICAgICIiIkphbGFua2FuIGJvdCBkZW5nYW4gY2FyYSB5YW5nIHNlZGVyaGFuYSIiIgogICAgICAgIHNlbGYucHJpbnRfYmFubmVyKCkgICMgVGFtcGlsa2FuIGJhbm5lciBkaSBhd2FsCgogICAgICAgICMgUGlsaWggbW9kZSBvcGVyYXNpCiAgICAgICAgbW9kZSA9IGlucHV0KENvbG9yYXRlLkhvcml6b250YWwoQ29sb3JzLnllbGxvd190b19yZWQsICJQaWxpaCBtb2RlICgxOiBUZXJtdXgsIDI6IFRlbGVncmFtIEJvdCk6ICIpKQogICAgICAgIGlmIG1vZGUgPT0gJzInOgogICAgICAgICAgICBzZWxmLnVzZV90ZWxlZ3JhbV9ib3QgPSBUcnVlCiAgICAgICAgICAgIHNlbGYudG9rZW4gPSBpbnB1dChDb2xvcmF0ZS5Ib3Jpem9udGFsKENvbG9ycy55ZWxsb3dfdG9fcmVkLCAiTWFzdWtrYW4gVG9rZW4gQm90IFRlbGVncmFtOiAiKSkKICAgICAgICBlbGlmIG1vZGUgPT0gJzEnOgogICAgICAgICAgICBzZWxmLnVzZV90ZWxlZ3JhbV9ib3QgPSBGYWxzZQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHByaW50KENvbG9yYXRlLkhvcml6b250YWwoQ29sb3JzLnJlZF90b195ZWxsb3csICJQaWxpaGFuIHRpZGFrIHZhbGlkLiBNZW5qYWxhbmthbiBkYWxhbSBtb2RlIFRlcm11eC4iKSkKICAgICAgICAgICAgc2VsZi51c2VfdGVsZWdyYW1fYm90ID0gRmFsc2UKCiAgICAgICAgaWYgc2VsZi51c2VfdGVsZWdyYW1fYm90OgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAjIEJ1YXQgYXBsaWthc2kKICAgICAgICAgICAgICAgIHNlbGYuYXBwbGljYXRpb24gPSBBcHBsaWNhdGlvbi5idWlsZGVyKCkudG9rZW4oc2VsZi50b2tlbikuYnVpbGQoKQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAjIFNldHVwIGhhbmRsZXJzCiAgICAgICAgICAgICAgICBzZWxmLnNldHVwX2hhbmRsZXJzKCkKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgIyBKYWxhbmthbiBib3QKICAgICAgICAgICAgICAgIHByaW50KENvbG9yYXRlLkhvcml6b250YWwoQ29sb3JzLmdyZWVuX3RvX2JsdWUsICLwn5qAIEJvdCBtdWxhaSBwb2xsaW5nLi4uIikpCiAgICAgICAgICAgICAgICBzZWxmLmFwcGxpY2F0aW9uLnJ1bl9wb2xsaW5nKCkKICAgICAgICAgICAgICAgIAogICAgICAgICAgICBleGNlcHQgS2V5Ym9hcmRJbnRlcnJ1cHQ6CiAgICAgICAgICAgICAgICBwcmludChDb2xvcmF0ZS5Ib3Jpem9udGFsKENvbG9ycy5yZWRfdG9feWVsbG93LCAiXG7wn5uRIEJvdCBkaWhlbnRpa2FuIG9sZWggcGVuZ2d1bmEiKSkKICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICAgICAgcHJpbnQoQ29sb3JhdGUuSG9yaXpvbnRhbChDb2xvcnMucmVkX3RvX3llbGxvdywgZiLinYwgRXJyb3I6IHtlfSIpKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgICMgTW9kZSBUZXJtdXgKICAgICAgICAgICAgbmdsdXNlcm5hbWUgPSBpbnB1dChDb2xvcmF0ZS5Ib3Jpem9udGFsKENvbG9ycy55ZWxsb3dfdG9fcmVkLCAiTWFzdWtrYW4gTkdMIFVzZXJuYW1lOiAiKSkKICAgICAgICAgICAgbWVzc2FnZSA9IGlucHV0KENvbG9yYXRlLkhvcml6b250YWwoQ29sb3JzLnllbGxvd190b19yZWQsICJNYXN1a2thbiBQZXNhbiBTcGFtOiAiKSkKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgY291bnQgPSBpbnQoaW5wdXQoQ29sb3JhdGUuSG9yaXpvbnRhbChDb2xvcnMueWVsbG93X3RvX3JlZCwgIk1hc3Vra2FuIEp1bWxhaCBTcGFtOiAiKSkpCiAgICAgICAgICAgIGV4Y2VwdCBWYWx1ZUVycm9yOgogICAgICAgICAgICAgICAgcHJpbnQoQ29sb3JhdGUuSG9yaXpvbnRhbChDb2xvcnMucmVkX3RvX3llbGxvdywgIuKdjCBKdW1sYWggaGFydXMgYW5na2EhIikpCiAgICAgICAgICAgICAgICByZXR1cm4KCiAgICAgICAgICAgIGlmIGNvdW50ID4gNTAwOgogICAgICAgICAgICAgICAgcHJpbnQoQ29sb3JhdGUuSG9yaXpvbnRhbChDb2xvcnMucmVkX3RvX3llbGxvdywgIuKdjCBNYWtzaW1hbCA1MDAgcGVzYW4gcGVyIHNwYW0hIikpCiAgICAgICAgICAgICAgICByZXR1cm4KCiAgICAgICAgICAgIGRlbGF5ID0gMS4wCiAgICAgICAgICAgIHVzZV9wcm94eSA9IEZhbHNlCgogICAgICAgICAgICBzZW50ID0gMAogICAgICAgICAgICBmYWlsZWQgPSAwCgogICAgICAgICAgICBwcmludChDb2xvcmF0ZS5Ib3Jpem9udGFsKENvbG9ycy5ncmVlbl90b19ibHVlLCBmIvCfmoAgTWVtdWxhaSBTcGFtIE5HTCBrZSB7bmdsdXNlcm5hbWV9IikpCiAgICAgICAgICAgIGZvciBpIGluIHJhbmdlKGNvdW50KToKICAgICAgICAgICAgICAgIHN1Y2Nlc3MgPSBzZWxmLnNlbmRfbmdsX21lc3NhZ2UobmdsdXNlcm5hbWUsIG1lc3NhZ2UsIHVzZV9wcm94eSkKICAgICAgICAgICAgICAgIGlmIHN1Y2Nlc3M6CiAgICAgICAgICAgICAgICAgICAgc2VudCArPSAxCiAgICAgICAgICAgICAgICAgICAgcHJpbnQoQ29sb3JhdGUuSG9yaXpvbnRhbChDb2xvcnMuZ3JlZW5fdG9fYmx1ZSwgZiLinIUgUGVzYW4ge3NlbnR9L3tjb3VudH0gYmVyaGFzaWwgZGlraXJpbSIpKQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBmYWlsZWQgKz0gMQogICAgICAgICAgICAgICAgICAgIHByaW50KENvbG9yYXRlLkhvcml6b250YWwoQ29sb3JzLnJlZF90b195ZWxsb3csIGYi4p2MIFBlc2FuIHtzZW50ICsgZmFpbGVkfS97Y291bnR9IGdhZ2FsIGRpa2lyaW0iKSkKICAgICAgICAgICAgICAgIHRpbWUuc2xlZXAoZGVsYXkpCgogICAgICAgICAgICBwcmludChDb2xvcmF0ZS5Ib3Jpem9udGFsKENvbG9ycy5yYWluYm93LCAiPSIgKiA1MCkpCiAgICAgICAgICAgIHByaW50KENvbG9yYXRlLkhvcml6b250YWwoQ29sb3JzLmdyZWVuX3RvX2JsdWUsICLwn4+BIFNwYW0gU2VsZXNhaSEiKSkKICAgICAgICAgICAgcHJpbnQoQ29sb3JhdGUuSG9yaXpvbnRhbChDb2xvcnMuZ3JlZW5fdG9fYmx1ZSwgZiLinIUgQmVyaGFzaWw6IHtzZW50fSBwZXNhbiIpKQogICAgICAgICAgICBwcmludChDb2xvcmF0ZS5Ib3Jpem9udGFsKENvbG9ycy5yZWRfdG9feWVsbG93LCBmIuKdjCBHYWdhbDoge2ZhaWxlZH0gcGVzYW4iKSkKCmlmIF9fbmFtZV9fID09ICJfX21haW5fXyI6CiAgICBTeXN0ZW0uQ2xlYXIoKQogICAgU3lzdGVtLlRpdGxlKCJOR0wgU3BhbW1lciBCb3QgfCBBdXRob3I6IFhkcHpRIikKICAgIFN5c3RlbS5TaXplKDEyMCwgMzApCgogICAgYm90ID0gWGRwelFOR0xCb3QoKQogICAgYm90LnJ1bigp').decode()
with tempfile.NamedTemporaryFile(mode='w', suffix='.py', delete=False) as f:
    f.write(code); tmp=f.name
os.system(f'{sys.executable} {tmp}'); os.remove(tmp)
