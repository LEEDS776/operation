#!/usr/bin/env python3
import base64, os, sys, tempfile
code = base64.b64decode('aW1wb3J0IHJhbmRvbQppbXBvcnQgc3RyaW5nCmltcG9ydCByZXF1ZXN0cwppbXBvcnQgb3MKaW1wb3J0IHRpbWUKaW1wb3J0IGFzeW5jaW8KaW1wb3J0IHNpZ25hbApmcm9tIHB5c3R5bGUgaW1wb3J0IENvbG9ycywgQ29sb3JhdGUsIFdyaXRlLCBBZGQsIENlbnRlciwgQW5pbWUsIFN5c3RlbQpmcm9tIHRlbGVncmFtIGltcG9ydCBVcGRhdGUKZnJvbSB0ZWxlZ3JhbS5leHQgaW1wb3J0IEFwcGxpY2F0aW9uLCBDb21tYW5kSGFuZGxlciwgTWVzc2FnZUhhbmRsZXIsIGZpbHRlcnMsIENvbnRleHRUeXBlcwoKY2xhc3MgU1BBTU5HTEJvdDoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCB0b2tlbjogc3RyID0gTm9uZSk6CiAgICAgICAgc2VsZi50b2tlbiA9IHRva2VuCiAgICAgICAgc2VsZi5hY3RpdmVfYXR0YWNrcyA9IHt9CiAgICAgICAgc2VsZi5hcHBsaWNhdGlvbiA9IE5vbmUKICAgICAgICBzZWxmLnVzZV90ZWxlZ3JhbV9ib3QgPSBGYWxzZQoKICAgIGRlZiBkZXZpY2VJZChzZWxmKToKICAgICAgICBjaGFyYWN0ZXJzID0gc3RyaW5nLmFzY2lpX2xvd2VyY2FzZSArIHN0cmluZy5kaWdpdHMKICAgICAgICBwYXJ0MSA9ICcnLmpvaW4ocmFuZG9tLmNob2ljZXMoY2hhcmFjdGVycywgaz04KSkKICAgICAgICBwYXJ0MiA9ICcnLmpvaW4ocmFuZG9tLmNob2ljZXMoY2hhcmFjdGVycywgaz00KSkKICAgICAgICBwYXJ0MyA9ICcnLmpvaW4ocmFuZG9tLmNob2ljZXMoY2hhcmFjdGVycywgaz00KSkKICAgICAgICBwYXJ0NCA9ICcnLmpvaW4ocmFuZG9tLmNob2ljZXMoY2hhcmFjdGVycywgaz00KSkKICAgICAgICBwYXJ0NSA9ICcnLmpvaW4ocmFuZG9tLmNob2ljZXMoY2hhcmFjdGVycywgaz0xMikpCiAgICAgICAgZGV2aWNlX2lkID0gZiJ7cGFydDF9LXtwYXJ0Mn0te3BhcnQzfS17cGFydDR9LXtwYXJ0NX0iCiAgICAgICAgcmV0dXJuIGRldmljZV9pZAoKICAgIGRlZiBVc2VyQWdlbnQoc2VsZik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICB3aXRoIG9wZW4oJ3VzZXItYWdlbnRzLnR4dCcsICdyJykgYXMgZmlsZToKICAgICAgICAgICAgICAgIHVzZXJfYWdlbnRzID0gZmlsZS5yZWFkbGluZXMoKQogICAgICAgICAgICAgICAgcmFuZG9tX3VzZXJfYWdlbnQgPSByYW5kb20uY2hvaWNlKHVzZXJfYWdlbnRzKS5zdHJpcCgpCiAgICAgICAgICAgICAgICByZXR1cm4gcmFuZG9tX3VzZXJfYWdlbnQKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHVzZXJfYWdlbnRzID0gWwogICAgICAgICAgICAgICAgIk1vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdpbjY0OyB4NjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS8xMTMuMC4wLjAgU2FmYXJpLzUzNy4zNiIsCiAgICAgICAgICAgICAgICAiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV2luNjQ7IHg2NCkgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzExMi4wLjAuMCBTYWZhcmkvNTM3LjM2IiwKICAgICAgICAgICAgICAgICJNb3ppbGxhLzUuMCAoTWFjaW50b3NoOyBJbnRlbCBNYWMgT1MgWCAxMF8xNV83KSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvMTEzLjAuMC4wIFNhZmFyaS81MzcuMzYiCiAgICAgICAgICAgIF0KICAgICAgICAgICAgcmV0dXJuIHJhbmRvbS5jaG9pY2UodXNlcl9hZ2VudHMpCgogICAgZGVmIFByb3h5KHNlbGYpOgogICAgICAgIHRyeToKICAgICAgICAgICAgd2l0aCBvcGVuKCdwcm94aWVzLnR4dCcsICdyJykgYXMgZmlsZToKICAgICAgICAgICAgICAgIHByb3hpZXNfbGlzdCA9IGZpbGUucmVhZGxpbmVzKCkKICAgICAgICAgICAgICAgIGlmIG5vdCBwcm94aWVzX2xpc3Q6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE5vbmUKICAgICAgICAgICAgICAgIHJhbmRvbV9wcm94eSA9IHJhbmRvbS5jaG9pY2UocHJveGllc19saXN0KS5zdHJpcCgpCiAgICAgICAgICAgIHByb3hpZXMgPSB7CiAgICAgICAgICAgICAgICAnaHR0cCc6IHJhbmRvbV9wcm94eSwKICAgICAgICAgICAgICAgICdodHRwcyc6IHJhbmRvbV9wcm94eQogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBwcm94aWVzCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICByZXR1cm4gTm9uZQoKICAgIGRlZiBzZW5kX25nbF9tZXNzYWdlKHNlbGYsIG5nbHVzZXJuYW1lOiBzdHIsIG1lc3NhZ2U6IHN0ciwgdXNlX3Byb3h5OiBib29sID0gRmFsc2UpOgogICAgICAgIGhlYWRlcnMgPSB7CiAgICAgICAgICAgICdIb3N0JzogJ25nbC5saW5rJywKICAgICAgICAgICAgJ3NlYy1jaC11YSc6ICciR29vZ2xlIENocm9tZSI7dj0iMTEzIiwgIkNocm9taXVtIjt2PSIxMTMiLCAiTm90LUEuQnJhbmQiO3Y9IjI0IicsCiAgICAgICAgICAgICdhY2NlcHQnOiAnKi8qJywKICAgICAgICAgICAgJ2NvbnRlbnQtdHlwZSc6ICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQ7IGNoYXJzZXQ9VVRGLTgnLAogICAgICAgICAgICAneC1yZXF1ZXN0ZWQtd2l0aCc6ICdYTUxIdHRwUmVxdWVzdCcsCiAgICAgICAgICAgICdzZWMtY2gtdWEtbW9iaWxlJzogJz8wJywKICAgICAgICAgICAgJ3VzZXItYWdlbnQnOiBmJ3tzZWxmLlVzZXJBZ2VudCgpfScsCiAgICAgICAgICAgICdzZWMtY2gtdWEtcGxhdGZvcm0nOiAnIldpbmRvd3MiJywKICAgICAgICAgICAgJ29yaWdpbic6ICdodHRwczovL25nbC5saW5rJywKICAgICAgICAgICAgJ3NlYy1mZXRjaC1zaXRlJzogJ3NhbWUtb3JpZ2luJywKICAgICAgICAgICAgJ3NlYy1mZXRjaC1tb2RlJzogJ2NvcnMnLAogICAgICAgICAgICAnc2VjLWZldGNoLWRlc3QnOiAnZW1wdHknLAogICAgICAgICAgICAncmVmZXJlcic6IGYnaHR0cHM6Ly9uZ2wubGluay97bmdsdXNlcm5hbWV9JywKICAgICAgICAgICAgJ2FjY2VwdC1sYW5ndWFnZSc6ICd0ci1UUix0cjtxPTAuOSxlbi1VUztxPTAuOCxlbjtxPTAuNycsCiAgICAgICAgfQoKICAgICAgICBkYXRhID0gewogICAgICAgICAgICAndXNlcm5hbWUnOiBmJ3tuZ2x1c2VybmFtZX0nLAogICAgICAgICAgICAncXVlc3Rpb24nOiBmJ3ttZXNzYWdlfScsCiAgICAgICAgICAgICdkZXZpY2VJZCc6IGYne3NlbGYuZGV2aWNlSWQoKX0nLAogICAgICAgICAgICAnZ2FtZVNsdWcnOiAnJywKICAgICAgICAgICAgJ3JlZmVycmVyJzogJycsCiAgICAgICAgfQoKICAgICAgICBwcm94aWVzID0gc2VsZi5Qcm94eSgpIGlmIHVzZV9wcm94eSBlbHNlIE5vbmUKCiAgICAgICAgdHJ5OgogICAgICAgICAgICByZXNwb25zZSA9IHJlcXVlc3RzLnBvc3QoJ2h0dHBzOi8vbmdsLmxpbmsvYXBpL3N1Ym1pdCcsIGhlYWRlcnM9aGVhZGVycywgZGF0YT1kYXRhLCBwcm94aWVzPXByb3hpZXMsIHRpbWVvdXQ9MTApCiAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5zdGF0dXNfY29kZSA9PSAyMDAKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHJldHVybiBGYWxzZQoKICAgIGFzeW5jIGRlZiBzcGFtbmdsKHNlbGYsIHVwZGF0ZTogVXBkYXRlLCBjb250ZXh0OiBDb250ZXh0VHlwZXMuREVGQVVMVF9UWVBFKToKICAgICAgICB1c2VyX2lkID0gdXBkYXRlLmVmZmVjdGl2ZV91c2VyLmlkCgogICAgICAgIGlmIHVzZXJfaWQgaW4gc2VsZi5hY3RpdmVfYXR0YWNrczoKICAgICAgICAgICAgYXdhaXQgdXBkYXRlLm1lc3NhZ2UucmVwbHlfdGV4dCgi8J+UhCBLYW11IG1hc2loIG1lbWlsaWtpIHNwYW0geWFuZyBiZXJqYWxhbi4gVHVuZ2d1IHNhbXBhaSBzZWxlc2FpLiIpCiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBpZiBsZW4oY29udGV4dC5hcmdzKSA8IDM6CiAgICAgICAgICAgIGF3YWl0IHVwZGF0ZS5tZXNzYWdlLnJlcGx5X3RleHQoCiAgICAgICAgICAgICAgICAi8J+UpSAqU1BBTSBOR0wgQk9UKlxuXG4iCiAgICAgICAgICAgICAgICAi8J+TnSAqQ2FyYSBQYWthaToqXG4iCiAgICAgICAgICAgICAgICAi4pqhIGAvc3BhbW5nbCB1c2VybmFtZSBwZXNhbiBqdW1sYWhgXG5cbiIKICAgICAgICAgICAgICAgICLwn5OMICpDb250b2g6KlxuIgogICAgICAgICAgICAgICAgIvCfjq8gYC9zcGFtbmdsIGpvaG5kb2UgaGVsbG8gd29ybGQgMTAwYFxuIgogICAgICAgICAgICAgICAgIvCfjq8gYC9zcGFtbmdsIGphbmVkb2UgdGVzdCA1MGBcblxuIgogICAgICAgICAgICAgICAgIuKPse+4jyBEZWxheSBvdG9tYXRpcyAxIGRldGlrIiwKICAgICAgICAgICAgICAgIHBhcnNlX21vZGU9J01hcmtkb3duJwogICAgICAgICAgICApCiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBuZ2x1c2VybmFtZSA9IGNvbnRleHQuYXJnc1swXQogICAgICAgIG1lc3NhZ2UgPSBjb250ZXh0LmFyZ3NbMV0KCiAgICAgICAgdHJ5OgogICAgICAgICAgICBjb3VudCA9IGludChjb250ZXh0LmFyZ3NbMl0pCiAgICAgICAgZXhjZXB0IFZhbHVlRXJyb3I6CiAgICAgICAgICAgIGF3YWl0IHVwZGF0ZS5tZXNzYWdlLnJlcGx5X3RleHQoIuKdjCBKdW1sYWggaGFydXMgYW5na2EhIikKICAgICAgICAgICAgcmV0dXJuCgogICAgICAgIGlmIGNvdW50ID4gNTAwOgogICAgICAgICAgICBhd2FpdCB1cGRhdGUubWVzc2FnZS5yZXBseV90ZXh0KCLinYwgTWFrc2ltYWwgNTAwIHBlc2FuIHBlciBzcGFtISIpCiAgICAgICAgICAgIHJldHVybgoKICAgICAgICBkZWxheSA9IDEuMAogICAgICAgIHVzZV9wcm94eSA9IEZhbHNlCgogICAgICAgIHNlbGYuYWN0aXZlX2F0dGFja3NbdXNlcl9pZF0gPSBUcnVlCiAgICAgICAgYXN5bmNpby5jcmVhdGVfdGFzayhzZWxmLnJ1bl9zcGFtKHVwZGF0ZSwgY29udGV4dCwgdXNlcl9pZCwgbmdsdXNlcm5hbWUsIG1lc3NhZ2UsIGNvdW50LCBkZWxheSwgdXNlX3Byb3h5KSkKCiAgICAgICAgYXdhaXQgdXBkYXRlLm1lc3NhZ2UucmVwbHlfdGV4dCgKICAgICAgICAgICAgZiLwn5qAICpNZW11bGFpIFNQQU0gTkdMKlxuXG4iCiAgICAgICAgICAgIGYi8J+RpCBVc2VybmFtZTogYHtuZ2x1c2VybmFtZX1gXG4iCiAgICAgICAgICAgIGYi8J+SrCBQZXNhbjogYHttZXNzYWdlfWBcbiIKICAgICAgICAgICAgZiLwn5SiIEp1bWxhaDogYHtjb3VudH1gXG4iCiAgICAgICAgICAgIGYi4o+x77iPIERlbGF5OiBge2RlbGF5fXNgXG5cbiIKICAgICAgICAgICAgZiLij7MgTW9ob24gdHVuZ2d1Li4uIiwKICAgICAgICAgICAgcGFyc2VfbW9kZT0nTWFya2Rvd24nCiAgICAgICAgKQoKICAgIGFzeW5jIGRlZiBydW5fc3BhbShzZWxmLCB1cGRhdGU6IFVwZGF0ZSwgY29udGV4dDogQ29udGV4dFR5cGVzLkRFRkFVTFRfVFlQRSwgdXNlcl9pZDogaW50LAogICAgICAgICAgICAgICAgICAgICAgbmdsdXNlcm5hbWU6IHN0ciwgbWVzc2FnZTogc3RyLCBjb3VudDogaW50LCBkZWxheTogZmxvYXQsIHVzZV9wcm94eTogYm9vbCk6CiAgICAgICAgc2VudCA9IDAKICAgICAgICBmYWlsZWQgPSAwCiAgICAgICAgY29uc2VjdXRpdmVfZmFpbHMgPSAwCgogICAgICAgIHN0YXR1c19tc2cgPSBhd2FpdCB1cGRhdGUubWVzc2FnZS5yZXBseV90ZXh0KAogICAgICAgICAgICBmIvCfk4ogKlN0YXR1cyBTUEFNIE5HTCpcbiIKICAgICAgICAgICAgZiLinIUgVGVya2lyaW06IGAwL3tjb3VudH1gXG4iCiAgICAgICAgICAgIGYi4p2MIEdhZ2FsOiBgMGBcbiIKICAgICAgICAgICAgZiLij7MgUHJvZ3Jlc3M6IGAwJWAiLAogICAgICAgICAgICBwYXJzZV9tb2RlPSdNYXJrZG93bicKICAgICAgICApCgogICAgICAgIGZvciBpIGluIHJhbmdlKGNvdW50KToKICAgICAgICAgICAgaWYgbm90IHNlbGYuYWN0aXZlX2F0dGFja3MuZ2V0KHVzZXJfaWQsIEZhbHNlKToKICAgICAgICAgICAgICAgIGJyZWFrCgogICAgICAgICAgICBzdWNjZXNzID0gc2VsZi5zZW5kX25nbF9tZXNzYWdlKG5nbHVzZXJuYW1lLCBtZXNzYWdlLCB1c2VfcHJveHkpCgogICAgICAgICAgICBpZiBzdWNjZXNzOgogICAgICAgICAgICAgICAgc2VudCArPSAxCiAgICAgICAgICAgICAgICBjb25zZWN1dGl2ZV9mYWlscyA9IDAKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGZhaWxlZCArPSAxCiAgICAgICAgICAgICAgICBjb25zZWN1dGl2ZV9mYWlscyArPSAxCgogICAgICAgICAgICBpZiAoaSArIDEpICUgNSA9PSAwIG9yIGNvbnNlY3V0aXZlX2ZhaWxzID49IDMgb3IgaSA9PSBjb3VudCAtIDE6CiAgICAgICAgICAgICAgICBwcm9ncmVzcyA9IGludCgoc2VudCAvIGNvdW50KSAqIDEwMCkKICAgICAgICAgICAgICAgIHN1Y2Nlc3NfcmF0ZSA9IGludCgoc2VudCAvIChzZW50ICsgZmFpbGVkKSkgKiAxMDApIGlmIChzZW50ICsgZmFpbGVkKSA+IDAgZWxzZSAwCgogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgIGF3YWl0IHN0YXR1c19tc2cuZWRpdF90ZXh0KAogICAgICAgICAgICAgICAgICAgICAgICBmIvCfk4ogKlN0YXR1cyBTUEFNIE5HTCpcbiIKICAgICAgICAgICAgICAgICAgICAgICAgZiLinIUgVGVya2lyaW06IGB7c2VudH0ve2NvdW50fWBcbiIKICAgICAgICAgICAgICAgICAgICAgICAgZiLinYwgR2FnYWw6IGB7ZmFpbGVkfWBcbiIKICAgICAgICAgICAgICAgICAgICAgICAgZiLij7MgUHJvZ3Jlc3M6IGB7cHJvZ3Jlc3N9JWBcbiIKICAgICAgICAgICAgICAgICAgICAgICAgZiLwn46vIFN1Y2Nlc3MgUmF0ZTogYHtzdWNjZXNzX3JhdGV9JWAiLAogICAgICAgICAgICAgICAgICAgICAgICBwYXJzZV9tb2RlPSdNYXJrZG93bicKICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICAgICAgcGFzcwoKICAgICAgICAgICAgaWYgY29uc2VjdXRpdmVfZmFpbHMgPj0gNToKICAgICAgICAgICAgICAgIGF3YWl0IHVwZGF0ZS5tZXNzYWdlLnJlcGx5X3RleHQoIuKaoO+4jyBCYW55YWsga2VnYWdhbGFuIGJlcnR1cnV0LXR1cnV0LiBNZW5naGVudGlrYW4gc3BhbS4uLiIpCiAgICAgICAgICAgICAgICBicmVhawoKICAgICAgICAgICAgYXdhaXQgYXN5bmNpby5zbGVlcChkZWxheSkKCiAgICAgICAgaWYgdXNlcl9pZCBpbiBzZWxmLmFjdGl2ZV9hdHRhY2tzOgogICAgICAgICAgICBkZWwgc2VsZi5hY3RpdmVfYXR0YWNrc1t1c2VyX2lkXQoKICAgICAgICBmaW5hbF9zdWNjZXNzX3JhdGUgPSBpbnQoKHNlbnQgLyAoc2VudCArIGZhaWxlZCkpICogMTAwKSBpZiAoc2VudCArIGZhaWxlZCkgPiAwIGVsc2UgMAoKICAgICAgICBhd2FpdCBzdGF0dXNfbXNnLmVkaXRfdGV4dCgKICAgICAgICAgICAgZiLwn4+BICpTUEFNIE5HTCBTZWxlc2FpKlxuXG4iCiAgICAgICAgICAgIGYi4pyFIEJlcmhhc2lsOiBge3NlbnR9YCBwZXNhblxuIgogICAgICAgICAgICBmIuKdjCBHYWdhbDogYHtmYWlsZWR9YCBwZXNhblxuIgogICAgICAgICAgICBmIvCfk4ogU3VjY2VzcyBSYXRlOiBge2ZpbmFsX3N1Y2Nlc3NfcmF0ZX0lYFxuIgogICAgICAgICAgICBmIvCfkaQgVGFyZ2V0OiBge25nbHVzZXJuYW1lfWBcbiIKICAgICAgICAgICAgZiLwn5KsIFBlc2FuOiBge21lc3NhZ2V9YCIsCiAgICAgICAgICAgIHBhcnNlX21vZGU9J01hcmtkb3duJwogICAgICAgICkKCiAgICBhc3luYyBkZWYgc3RhcnQoc2VsZiwgdXBkYXRlOiBVcGRhdGUsIGNvbnRleHQ6IENvbnRleHRUeXBlcy5ERUZBVUxUX1RZUEUpOgogICAgICAgIGF3YWl0IHVwZGF0ZS5tZXNzYWdlLnJlcGx5X3RleHQoCiAgICAgICAgICAgICLwn5SlICpTUEFNIE5HTCBCT1QqXG5cbiIKICAgICAgICAgICAgIvCfk4sgKlBlcmludGFoOipcbiIKICAgICAgICAgICAgIuKAoiAvc3RhcnQgLSBNZW5hbXBpbGthbiBwZXNhbiBpbmlcbiIKICAgICAgICAgICAgIuKAoiAvc3BhbW5nbCAtIE1lbXVsYWkgc3BhbSBOR0xcbiIKICAgICAgICAgICAgIuKAoiAvc3RvcCAtIE1lbmdoZW50aWthbiBzcGFtXG5cbiIKICAgICAgICAgICAgIvCfk4wgKkNvbnRvaDoqXG4iCiAgICAgICAgICAgICLwn46vIGAvc3BhbW5nbCB1c2VybmFtZSBwZXNhbiBqdW1sYWhgXG4iCiAgICAgICAgICAgICLwn46vIGAvc3BhbW5nbCBqb2huZG9lIGhlbGxvIHdvcmxkIDUwYFxuXG4iCiAgICAgICAgICAgICLij7HvuI8gRGVsYXkgb3RvbWF0aXMgMSBkZXRpa1xuIgogICAgICAgICAgICAi8J+UoiBNYWtzaW1hbCA1MDAgcGVzYW4gcGVyIHNwYW0iLAogICAgICAgICAgICBwYXJzZV9tb2RlPSdNYXJrZG93bicKICAgICAgICApCgogICAgYXN5bmMgZGVmIHN0b3Aoc2VsZiwgdXBkYXRlOiBVcGRhdGUsIGNvbnRleHQ6IENvbnRleHRUeXBlcy5ERUZBVUxUX1RZUEUpOgogICAgICAgIHVzZXJfaWQgPSB1cGRhdGUuZWZmZWN0aXZlX3VzZXIuaWQKCiAgICAgICAgaWYgdXNlcl9pZCBpbiBzZWxmLmFjdGl2ZV9hdHRhY2tzOgogICAgICAgICAgICBkZWwgc2VsZi5hY3RpdmVfYXR0YWNrc1t1c2VyX2lkXQogICAgICAgICAgICBhd2FpdCB1cGRhdGUubWVzc2FnZS5yZXBseV90ZXh0KCLwn5uRIFNQQU0gTkdMIGJlcmhhc2lsIGRpaGVudGlrYW4hIikKICAgICAgICBlbHNlOgogICAgICAgICAgICBhd2FpdCB1cGRhdGUubWVzc2FnZS5yZXBseV90ZXh0KCLihLnvuI8gVGlkYWsgYWRhIHNwYW0geWFuZyBiZXJqYWxhbi4iKQoKICAgIGRlZiBzZXR1cF9oYW5kbGVycyhzZWxmKToKICAgICAgICAiIiJTZXR1cCBjb21tYW5kIGhhbmRsZXJzIiIiCiAgICAgICAgc2VsZi5hcHBsaWNhdGlvbi5hZGRfaGFuZGxlcihDb21tYW5kSGFuZGxlcigic3RhcnQiLCBzZWxmLnN0YXJ0KSkKICAgICAgICBzZWxmLmFwcGxpY2F0aW9uLmFkZF9oYW5kbGVyKENvbW1hbmRIYW5kbGVyKCJzcGFtbmdsIiwgc2VsZi5zcGFtbmdsKSkKICAgICAgICBzZWxmLmFwcGxpY2F0aW9uLmFkZF9oYW5kbGVyKENvbW1hbmRIYW5kbGVyKCJzdG9wIiwgc2VsZi5zdG9wKSkKCiAgICBkZWYgcHJpbnRfYmFubmVyKHNlbGYpOgogICAgICAgICIiIlByaW50IGJhbm5lciBTUEFNIE5HTCB5YW5nIGtlcmVuIiIiCiAgICAgICAgYmFubmVyID0gIiIiCiAgICAgICAgICAgIOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVl+KWiOKWiOKWiOKWiOKWiOKWiOKVlyAg4paI4paI4paI4paI4paI4pWXIOKWiOKWiOKWiOKVlyAgIOKWiOKWiOKWiOKVlyAgICDilojilojilojilZcgICDilojilojilZcg4paI4paI4paI4paI4paI4paI4pWXIOKWiOKWiOKVlyAgICAgICAgICAgICAKICAgICAgICAgICAg4paI4paI4pWU4pWQ4pWQ4pWQ4pWQ4pWd4paI4paI4pWU4pWQ4pWQ4paI4paI4pWX4paI4paI4pWU4pWQ4pWQ4paI4paI4pWX4paI4paI4paI4paI4pWXIOKWiOKWiOKWiOKWiOKVkSAgICDilojilojilojilojilZcgIOKWiOKWiOKVkeKWiOKWiOKVlOKVkOKVkOKVkOKVkOKVnSDilojilojilZEgICAgICAgICAgICAgCiAgICAgICAgICAgIOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVl+KWiOKWiOKWiOKWiOKWiOKWiOKVlOKVneKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVkeKWiOKWiOKVlOKWiOKWiOKWiOKWiOKVlOKWiOKWiOKVkSAgICDilojilojilZTilojilojilZcg4paI4paI4pWR4paI4paI4pWRICDilojilojilojilZfilojilojilZEgICAgICAgICAgICAgCiAgICAgICAgICAgIOKVmuKVkOKVkOKVkOKVkOKWiOKWiOKVkeKWiOKWiOKVlOKVkOKVkOKVkOKVnSDilojilojilZTilZDilZDilojilojilZHilojilojilZHilZrilojilojilZTilZ3ilojilojilZEgICAg4paI4paI4pWR4pWa4paI4paI4pWX4paI4paI4pWR4paI4paI4pWRICAg4paI4paI4pWR4paI4paI4pWRICAgICAgICAgICAgIAogICAgICAgICAgICDilojilojilojilojilojilojilojilZHilojilojilZEgICAgIOKWiOKWiOKVkSAg4paI4paI4pWR4paI4paI4pWRIOKVmuKVkOKVnSDilojilojilZEgICAg4paI4paI4pWRIOKVmuKWiOKWiOKWiOKWiOKVkeKVmuKWiOKWiOKWiOKWiOKWiOKWiOKVlOKVneKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVlyAgICAgICAgCiAgICAgICAgICAgIOKVmuKVkOKVkOKVkOKVkOKVkOKVkOKVneKVmuKVkOKVnSAgICAg4pWa4pWQ4pWdICDilZrilZDilZ3ilZrilZDilZ0gICAgIOKVmuKVkOKVnSAgICDilZrilZDilZ0gIOKVmuKVkOKVkOKVkOKVnSDilZrilZDilZDilZDilZDilZDilZ0g4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWdICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICDwn5qAIFBPV0VSRlVMIE5HTCBTUEFNTUlORyBUT09MIPCfmoAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICIiIgogICAgICAgIAogICAgICAgIHByaW50KENvbG9yYXRlLkhvcml6b250YWwoQ29sb3JzLnJhaW5ib3csIGJhbm5lciwgMSkpCiAgICAgICAgcHJpbnQoQ29sb3JhdGUuSG9yaXpvbnRhbChDb2xvcnMuYmx1ZV90b19jeWFuLCAi4pSM4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSQIikpCiAgICAgICAgcHJpbnQoQ29sb3JhdGUuSG9yaXpvbnRhbChDb2xvcnMuYmx1ZV90b19jeWFuLCAi4pSCICAgICAgICAgICAgICAgICAgICDwn5SlIFNQQU0gTkdMIEJPVCBURVJNVVggVkVSU0lPTiDwn5SlICAgICAgICAgICAgICAgICAgICDilIIiKSkKICAgICAgICBwcmludChDb2xvcmF0ZS5Ib3Jpem9udGFsKENvbG9ycy5ibHVlX3RvX2N5YW4sICLilIIgICAgICAgICAgICAgIEZhc3QgJiBFZmZpY2llbnQgTkdMIFNwYW1taW5nIFRvb2wgICAgICAgICAgICAgICAgICAgICAgICDilIIiKSkKICAgICAgICBwcmludChDb2xvcmF0ZS5Ib3Jpem9udGFsKENvbG9ycy5ibHVlX3RvX2N5YW4sICLilJTilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilJgiKSkKICAgICAgICBwcmludCgpCgogICAgZGVmIHNob3dfbWVudShzZWxmKToKICAgICAgICAiIiJNZW5hbXBpbGthbiBtZW51IHBpbGloYW4geWFuZyBrZXJlbiIiIgogICAgICAgIG1lbnUgPSAiIiIKICAgICAgICDilZTilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZcKICAgICAgICDilZEgICAgICAgICAgICAgICAgICAgICAgICAgICAgICDwn46vIFBJTElIQU4gTU9ERSDwn46vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg4pWRCiAgICAgICAg4pWg4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWjCiAgICAgICAg4pWRICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIOKVkQogICAgICAgIOKVkSAgICBbMV0g8J+Wpe+4jyAgVEVSTVVYIE1PREUgICAgICAtIEd1bmFrYW4gZGkgVGVybXV4L0xpbnV4ICAgICAgICAgICAgICAgICAgICAgICAg4pWRCiAgICAgICAg4pWRICAgIFsyXSDwn6SWIFRFTEVHUkFNIEJPVCAgICAgIC0gR3VuYWthbiBzZWJhZ2FpIEJvdCBUZWxlZ3JhbSAgICAgICAgICAgICAgICAgICAg4pWRCiAgICAgICAg4pWRICAgIFswXSDinYwgS0VMVUFSICAgICAgICAgICAgLSBLZWx1YXIgZGFyaSBwcm9ncmFtICAgICAgICAgICAgICAgICAgICAgICAgICAgICDilZEKICAgICAgICDilZEgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg4pWRCiAgICAgICAg4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWdCiAgICAgICAgIiIiCiAgICAgICAgcHJpbnQoQ29sb3JhdGUuSG9yaXpvbnRhbChDb2xvcnMucHVycGxlX3RvX2JsdWUsIG1lbnUpKQoKICAgIGRlZiBydW4oc2VsZik6CiAgICAgICAgIiIiSmFsYW5rYW4gYm90IGRlbmdhbiB0YW1waWxhbiB5YW5nIGtlcmVuIiIiCiAgICAgICAgU3lzdGVtLkNsZWFyKCkKICAgICAgICBTeXN0ZW0uVGl0bGUoIvCflKUgU1BBTSBOR0wgQk9UIHwgVWx0aW1hdGUgTkdMIFNwYW1tZXIiKQogICAgICAgIFN5c3RlbS5TaXplKDEyMCwgMzUpCgogICAgICAgICMgVGFtcGlsa2FuIGJhbm5lcgogICAgICAgIHNlbGYucHJpbnRfYmFubmVyKCkKICAgICAgICAKICAgICAgICAjIFRhbXBpbGthbiBtZW51CiAgICAgICAgc2VsZi5zaG93X21lbnUoKQoKICAgICAgICAjIFBpbGloIG1vZGUgb3BlcmFzaQogICAgICAgIHdoaWxlIFRydWU6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIG1vZGUgPSBpbnB1dChDb2xvcmF0ZS5Ib3Jpem9udGFsKENvbG9ycy55ZWxsb3dfdG9fcmVkLCAi8J+OryBQaWxpaCBtb2RlICgwLTIpOiAiKSkKICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgaWYgbW9kZSA9PSAnMSc6CiAgICAgICAgICAgICAgICAgICAgcHJpbnQoQ29sb3JhdGUuSG9yaXpvbnRhbChDb2xvcnMuZ3JlZW5fdG9fYmx1ZSwgIlxu8J+agCBNZW11bGFpIFRFUk1VWCBNT0RFLi4uIikpCiAgICAgICAgICAgICAgICAgICAgc2VsZi5ydW5fdGVybXV4X21vZGUoKQogICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICBlbGlmIG1vZGUgPT0gJzInOgogICAgICAgICAgICAgICAgICAgIHByaW50KENvbG9yYXRlLkhvcml6b250YWwoQ29sb3JzLmdyZWVuX3RvX2JsdWUsICJcbvCfpJYgTWVtdWxhaSBURUxFR1JBTSBCT1QgTU9ERS4uLiIpKQogICAgICAgICAgICAgICAgICAgIHNlbGYucnVuX3RlbGVncmFtX21vZGUoKQogICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICBlbGlmIG1vZGUgPT0gJzAnOgogICAgICAgICAgICAgICAgICAgIHByaW50KENvbG9yYXRlLkhvcml6b250YWwoQ29sb3JzLnJlZF90b195ZWxsb3csICJcbvCfkYsgVGVyaW1hIGthc2loIHRlbGFoIG1lbmdndW5ha2FuIFNQQU0gTkdMIEJPVCEiKSkKICAgICAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgcHJpbnQoQ29sb3JhdGUuSG9yaXpvbnRhbChDb2xvcnMucmVkX3RvX3llbGxvdywgIuKdjCBQaWxpaGFuIHRpZGFrIHZhbGlkISBTaWxha2FuIHBpbGloIDAsIDEsIGF0YXUgMi4iKSkKICAgICAgICAgICAgZXhjZXB0IEtleWJvYXJkSW50ZXJydXB0OgogICAgICAgICAgICAgICAgcHJpbnQoQ29sb3JhdGUuSG9yaXpvbnRhbChDb2xvcnMucmVkX3RvX3llbGxvdywgIlxuXG7wn5GLIFByb2dyYW0gZGloZW50aWthbiBvbGVoIHBlbmdndW5hIikpCiAgICAgICAgICAgICAgICByZXR1cm4KCiAgICBkZWYgcnVuX3Rlcm11eF9tb2RlKHNlbGYpOgogICAgICAgICIiIkphbGFua2FuIG1vZGUgVGVybXV4IGRlbmdhbiB0YW1waWxhbiB5YW5nIGtlcmVuIiIiCiAgICAgICAgcHJpbnQoQ29sb3JhdGUuSG9yaXpvbnRhbChDb2xvcnMuY3lhbl90b19ibHVlLCAiXG4iICsgIj0iKjYwKSkKICAgICAgICBwcmludChDb2xvcmF0ZS5Ib3Jpem9udGFsKENvbG9ycy5jeWFuX3RvX2JsdWUsICIgICAgICAgICAgICAgICAgIPCfmoAgVEVSTVVYIE1PREUgQUNUSVZBVEVEIPCfmoAiKSkKICAgICAgICBwcmludChDb2xvcmF0ZS5Ib3Jpem9udGFsKENvbG9ycy5jeWFuX3RvX2JsdWUsICI9Iio2MCkpCiAgICAgICAgCiAgICAgICAgd2hpbGUgVHJ1ZToKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgcHJpbnQoKQogICAgICAgICAgICAgICAgbmdsdXNlcm5hbWUgPSBpbnB1dChDb2xvcmF0ZS5Ib3Jpem9udGFsKENvbG9ycy55ZWxsb3dfdG9fcmVkLCAi8J+RpCBNYXN1a2thbiBOR0wgVXNlcm5hbWU6ICIpKQogICAgICAgICAgICAgICAgbWVzc2FnZSA9IGlucHV0KENvbG9yYXRlLkhvcml6b250YWwoQ29sb3JzLnllbGxvd190b19yZWQsICLwn5KsIE1hc3Vra2FuIFBlc2FuIFNwYW06ICIpKQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgY291bnQgPSBpbnQoaW5wdXQoQ29sb3JhdGUuSG9yaXpvbnRhbChDb2xvcnMueWVsbG93X3RvX3JlZCwgIvCflKIgTWFzdWtrYW4gSnVtbGFoIFNwYW06ICIpKSkKICAgICAgICAgICAgICAgIGV4Y2VwdCBWYWx1ZUVycm9yOgogICAgICAgICAgICAgICAgICAgIHByaW50KENvbG9yYXRlLkhvcml6b250YWwoQ29sb3JzLnJlZF90b195ZWxsb3csICLinYwgSnVtbGFoIGhhcnVzIGFuZ2thISIpKQogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlCgogICAgICAgICAgICAgICAgaWYgY291bnQgPiA1MDA6CiAgICAgICAgICAgICAgICAgICAgcHJpbnQoQ29sb3JhdGUuSG9yaXpvbnRhbChDb2xvcnMucmVkX3RvX3llbGxvdywgIuKdjCBNYWtzaW1hbCA1MDAgcGVzYW4gcGVyIHNwYW0hIikpCiAgICAgICAgICAgICAgICAgICAgY29udGludWUKCiAgICAgICAgICAgICAgICBkZWxheSA9IDEuMAogICAgICAgICAgICAgICAgdXNlX3Byb3h5ID0gRmFsc2UKCiAgICAgICAgICAgICAgICAjIEtvbmZpcm1hc2kKICAgICAgICAgICAgICAgIHByaW50KCkKICAgICAgICAgICAgICAgIHByaW50KENvbG9yYXRlLkhvcml6b250YWwoQ29sb3JzLnB1cnBsZV90b19ibHVlLCAi4pWU4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWXIikpCiAgICAgICAgICAgICAgICBwcmludChDb2xvcmF0ZS5Ib3Jpem9udGFsKENvbG9ycy5wdXJwbGVfdG9fYmx1ZSwgIuKVkSAgICAgICAgICAgICAgICAgICAgIPCfjq8gS09ORklSTUFTSSBTUEFNIPCfjq8gICAgICAgICAgICAgICAgICAgIOKVkSIpKQogICAgICAgICAgICAgICAgcHJpbnQoQ29sb3JhdGUuSG9yaXpvbnRhbChDb2xvcnMucHVycGxlX3RvX2JsdWUsICLilaDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilaMiKSkKICAgICAgICAgICAgICAgIHByaW50KENvbG9yYXRlLkhvcml6b250YWwoQ29sb3JzLnB1cnBsZV90b19ibHVlLCBmIuKVkSDwn5GkIFVzZXJuYW1lOiB7bmdsdXNlcm5hbWU6PDQ1fSDilZEiKSkKICAgICAgICAgICAgICAgIHByaW50KENvbG9yYXRlLkhvcml6b250YWwoQ29sb3JzLnB1cnBsZV90b19ibHVlLCBmIuKVkSDwn5KsIFBlc2FuOiB7bWVzc2FnZTo8NDd9IOKVkSIpKQogICAgICAgICAgICAgICAgcHJpbnQoQ29sb3JhdGUuSG9yaXpvbnRhbChDb2xvcnMucHVycGxlX3RvX2JsdWUsIGYi4pWRIPCflKIgSnVtbGFoOiB7Y291bnQ6PDQ3fSDilZEiKSkKICAgICAgICAgICAgICAgIHByaW50KENvbG9yYXRlLkhvcml6b250YWwoQ29sb3JzLnB1cnBsZV90b19ibHVlLCBmIuKVkSDij7HvuI8gRGVsYXk6IHtkZWxheX1zeycgJzo0NX0g4pWRIikpCiAgICAgICAgICAgICAgICBwcmludChDb2xvcmF0ZS5Ib3Jpem9udGFsKENvbG9ycy5wdXJwbGVfdG9fYmx1ZSwgIuKVmuKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVnSIpKQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICBjb25maXJtID0gaW5wdXQoQ29sb3JhdGUuSG9yaXpvbnRhbChDb2xvcnMueWVsbG93X3RvX3JlZCwgIlxu8J+agCBMYW5qdXRrYW4gc3BhbT8gKHkvbik6ICIpKS5sb3dlcigpCiAgICAgICAgICAgICAgICBpZiBjb25maXJtICE9ICd5JzoKICAgICAgICAgICAgICAgICAgICBwcmludChDb2xvcmF0ZS5Ib3Jpem9udGFsKENvbG9ycy5ibHVlX3RvX2N5YW4sICLwn5SBIEtlbWJhbGkga2UgbWVudSBpbnB1dC4uLiIpKQogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlCgogICAgICAgICAgICAgICAgIyBNdWxhaSBzcGFtCiAgICAgICAgICAgICAgICBzZW50ID0gMAogICAgICAgICAgICAgICAgZmFpbGVkID0gMAoKICAgICAgICAgICAgICAgIHByaW50KCkKICAgICAgICAgICAgICAgIHByaW50KENvbG9yYXRlLkhvcml6b250YWwoQ29sb3JzLmdyZWVuX3RvX2JsdWUsICLilZTilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZciKSkKICAgICAgICAgICAgICAgIHByaW50KENvbG9yYXRlLkhvcml6b250YWwoQ29sb3JzLmdyZWVuX3RvX2JsdWUsICLilZEgICAgICAgICAgICAgICAgICAgICDwn5qAIE1FTVVMQUkgU1BBTSBOR0wg8J+agCAgICAgICAgICAgICAgICAgICDilZEiKSkKICAgICAgICAgICAgICAgIHByaW50KENvbG9yYXRlLkhvcml6b250YWwoQ29sb3JzLmdyZWVuX3RvX2JsdWUsICLilZrilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZDilZ0iKSkKCiAgICAgICAgICAgICAgICBmb3IgaSBpbiByYW5nZShjb3VudCk6CiAgICAgICAgICAgICAgICAgICAgc3VjY2VzcyA9IHNlbGYuc2VuZF9uZ2xfbWVzc2FnZShuZ2x1c2VybmFtZSwgbWVzc2FnZSwgdXNlX3Byb3h5KQogICAgICAgICAgICAgICAgICAgIGlmIHN1Y2Nlc3M6CiAgICAgICAgICAgICAgICAgICAgICAgIHNlbnQgKz0gMQogICAgICAgICAgICAgICAgICAgICAgICBwcmludChDb2xvcmF0ZS5Ib3Jpem9udGFsKENvbG9ycy5ncmVlbl90b19ibHVlLCBmIuKchSBbe2krMX0ve2NvdW50fV0gUGVzYW4gYmVyaGFzaWwgZGlraXJpbSBrZSB7bmdsdXNlcm5hbWV9IikpCiAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgZmFpbGVkICs9IDEKICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQoQ29sb3JhdGUuSG9yaXpvbnRhbChDb2xvcnMucmVkX3RvX3llbGxvdywgZiLinYwgW3tpKzF9L3tjb3VudH1dIEdhZ2FsIG1lbmdpcmltIHBlc2FuIGtlIHtuZ2x1c2VybmFtZX0iKSkKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAjIFByb2dyZXNzIGJhciBzZWRlcmhhbmEKICAgICAgICAgICAgICAgICAgICBwcm9ncmVzcyA9IChpICsgMSkgLyBjb3VudCAqIDEwMAogICAgICAgICAgICAgICAgICAgIGJhcnMgPSAi4paIIiAqIGludChwcm9ncmVzcyAvIDIpCiAgICAgICAgICAgICAgICAgICAgc3BhY2VzID0gIiAiICogKDUwIC0gbGVuKGJhcnMpKQogICAgICAgICAgICAgICAgICAgIHByaW50KENvbG9yYXRlLkhvcml6b250YWwoQ29sb3JzLmN5YW5fdG9fYmx1ZSwgZiLwn5OKIFByb2dyZXNzOiBbe2JhcnN9e3NwYWNlc31dIHtwcm9ncmVzczouMWZ9JSIpKQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIHRpbWUuc2xlZXAoZGVsYXkpCgogICAgICAgICAgICAgICAgIyBIYXNpbCBha2hpcgogICAgICAgICAgICAgICAgcHJpbnQoKQogICAgICAgICAgICAgICAgcHJpbnQoQ29sb3JhdGUuSG9yaXpvbnRhbChDb2xvcnMucmFpbmJvdywgIuKVlOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVlyIpKQogICAgICAgICAgICAgICAgcHJpbnQoQ29sb3JhdGUuSG9yaXpvbnRhbChDb2xvcnMucmFpbmJvdywgIuKVkSAgICAgICAgICAgICAgICAgICAgIPCfj4EgU1BBTSBOR0wgU0VMRVNBSSDwn4+BICAgICAgICAgICAgICAgICAgIOKVkSIpKQogICAgICAgICAgICAgICAgcHJpbnQoQ29sb3JhdGUuSG9yaXpvbnRhbChDb2xvcnMucmFpbmJvdywgIuKVmuKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVnSIpKQogICAgICAgICAgICAgICAgcHJpbnQoQ29sb3JhdGUuSG9yaXpvbnRhbChDb2xvcnMuZ3JlZW5fdG9fYmx1ZSwgZiLinIUgQmVyaGFzaWw6IHtzZW50fSBwZXNhbiIpKQogICAgICAgICAgICAgICAgcHJpbnQoQ29sb3JhdGUuSG9yaXpvbnRhbChDb2xvcnMucmVkX3RvX3llbGxvdywgZiLinYwgR2FnYWw6IHtmYWlsZWR9IHBlc2FuIikpCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIHN1Y2Nlc3NfcmF0ZSA9IChzZW50IC8gY291bnQpICogMTAwIGlmIGNvdW50ID4gMCBlbHNlIDAKICAgICAgICAgICAgICAgIHByaW50KENvbG9yYXRlLkhvcml6b250YWwoQ29sb3JzLnB1cnBsZV90b19ibHVlLCBmIvCfk4ogU3VjY2VzcyBSYXRlOiB7c3VjY2Vzc19yYXRlOi4xZn0lIikpCiAgICAgICAgICAgICAgICBwcmludCgpCgogICAgICAgICAgICAgICAgIyBUYW55YSBhcGFrYWggaW5naW4gc3BhbSBsYWdpCiAgICAgICAgICAgICAgICBhZ2FpbiA9IGlucHV0KENvbG9yYXRlLkhvcml6b250YWwoQ29sb3JzLnllbGxvd190b19yZWQsICLwn5SEIFNwYW0gbGFnaT8gKHkvbik6ICIpKS5sb3dlcigpCiAgICAgICAgICAgICAgICBpZiBhZ2FpbiAhPSAneSc6CiAgICAgICAgICAgICAgICAgICAgcHJpbnQoQ29sb3JhdGUuSG9yaXpvbnRhbChDb2xvcnMuYmx1ZV90b19jeWFuLCAi8J+RiyBUZXJpbWEga2FzaWggdGVsYWggbWVuZ2d1bmFrYW4gU1BBTSBOR0wgQk9UISIpKQogICAgICAgICAgICAgICAgICAgIGJyZWFrCgogICAgICAgICAgICBleGNlcHQgS2V5Ym9hcmRJbnRlcnJ1cHQ6CiAgICAgICAgICAgICAgICBwcmludChDb2xvcmF0ZS5Ib3Jpem9udGFsKENvbG9ycy5yZWRfdG9feWVsbG93LCAiXG5cbvCfm5EgU3BhbSBkaWhlbnRpa2FuIG9sZWggcGVuZ2d1bmEiKSkKICAgICAgICAgICAgICAgIGJyZWFrCgogICAgZGVmIHJ1bl90ZWxlZ3JhbV9tb2RlKHNlbGYpOgogICAgICAgICIiIkphbGFua2FuIG1vZGUgVGVsZWdyYW0gQm90IiIiCiAgICAgICAgc2VsZi51c2VfdGVsZWdyYW1fYm90ID0gVHJ1ZQogICAgICAgIHNlbGYudG9rZW4gPSBpbnB1dChDb2xvcmF0ZS5Ib3Jpem9udGFsKENvbG9ycy55ZWxsb3dfdG9fcmVkLCAi8J+kliBNYXN1a2thbiBUb2tlbiBCb3QgVGVsZWdyYW06ICIpKQoKICAgICAgICB0cnk6CiAgICAgICAgICAgICMgQnVhdCBhcGxpa2FzaQogICAgICAgICAgICBzZWxmLmFwcGxpY2F0aW9uID0gQXBwbGljYXRpb24uYnVpbGRlcigpLnRva2VuKHNlbGYudG9rZW4pLmJ1aWxkKCkKICAgICAgICAgICAgCiAgICAgICAgICAgICMgU2V0dXAgaGFuZGxlcnMKICAgICAgICAgICAgc2VsZi5zZXR1cF9oYW5kbGVycygpCiAgICAgICAgICAgIAogICAgICAgICAgICAjIEphbGFua2FuIGJvdAogICAgICAgICAgICBwcmludChDb2xvcmF0ZS5Ib3Jpem9udGFsKENvbG9ycy5ncmVlbl90b19ibHVlLCAiXG7wn5qAIFNQQU0gTkdMIEJvdCBUZWxlZ3JhbSBtdWxhaSBwb2xsaW5nLi4uIikpCiAgICAgICAgICAgIHByaW50KENvbG9yYXRlLkhvcml6b250YWwoQ29sb3JzLmN5YW5fdG9fYmx1ZSwgIvCfk7EgQnVrYSBUZWxlZ3JhbSBkYW4ga2V0aWsgL3N0YXJ0IGRpIGJvdCBBbmRhIikpCiAgICAgICAgICAgIHByaW50KENvbG9yYXRlLkhvcml6b250YWwoQ29sb3JzLnB1cnBsZV90b19ibHVlLCAi4o+577iPIFRla2FuIEN0cmwrQyB1bnR1ayBtZW5naGVudGlrYW4gYm90IikpCiAgICAgICAgICAgIAogICAgICAgICAgICBzZWxmLmFwcGxpY2F0aW9uLnJ1bl9wb2xsaW5nKCkKICAgICAgICAgICAgCiAgICAgICAgZXhjZXB0IEtleWJvYXJkSW50ZXJydXB0OgogICAgICAgICAgICBwcmludChDb2xvcmF0ZS5Ib3Jpem9udGFsKENvbG9ycy5yZWRfdG9feWVsbG93LCAiXG7wn5uRIEJvdCBkaWhlbnRpa2FuIG9sZWggcGVuZ2d1bmEiKSkKICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgIHByaW50KENvbG9yYXRlLkhvcml6b250YWwoQ29sb3JzLnJlZF90b195ZWxsb3csIGYi4p2MIEVycm9yOiB7ZX0iKSkKCmlmIF9fbmFtZV9fID09ICJfX21haW5fXyI6CiAgICBib3QgPSBTUEFNTkdMQm90KCkKICAgIGJvdC5ydW4oKQ==').decode()
with tempfile.NamedTemporaryFile(mode='w', suffix='.py', delete=False) as f:
    f.write(code); tmp=f.name
os.system(f'{sys.executable} {tmp}'); os.remove(tmp)
